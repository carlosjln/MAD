/**
 * MAD
 * Modular Application Development
 *
 * https://github.com/carlosjln/mad
 * https://github.com/carlosjln/mad-nodejs
 * https://github.com/carlosjln/mad-examples
 *
 * Author: Carlos J. Lopez
 * https://github.com/carlosjln
 * 
 * @license MIT
 */
window.MAD=window.MAD||{version:"0.0.1"},String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}),function(t){function e(t,n,r){var o,i,a=c(t);if(r=r===!0,"date"===a)return n=new Date,n.setTime(t.getTime()),n;if("array"===a&&r===!1){var u=t.length;for(n=void 0===n?[]:n;u--;)n[u]=e(t[u],n[u],r);return n}if("object"===a){n=void 0===n?{}:n;for(var l in t)t.hasOwnProperty(l)&&(o=t[l],i=n[l],n[l]=e(o,i,r));return n}return r&&void 0!==n?n:t}function n(){for(var t=arguments,n=t.length,r={},o=0;o<n;o++)e(t[o],r);return r}function r(t,e){for(var n,r=t.length,o=0,i=[];o<r;o++)n=t[o],e(n)&&(i[i.length]=n);return i}function o(t){for(var e,n,r,o,c,u,l,s=a,d=i(t),f=d.length,p=0,h="";p<f;)e=d.charCodeAt(p++),n=d.charCodeAt(p++),r=d.charCodeAt(p++),o=e>>2,c=(3&e)<<4|n>>4,u=(15&n)<<2|r>>6,l=63&r,isNaN(n)?u=l=64:isNaN(r)&&(l=64),h=h+s.charAt(o)+s.charAt(c)+s.charAt(u)+s.charAt(l);return h}function i(t){for(var e,n=t.replace(/\r\n/g,"\n"),r=n.length,o=0,i="";r--;)e=n.charCodeAt(o++),e<128?i+=String.fromCharCode(e):e>127&&e<2048?(i+=String.fromCharCode(e>>6|192),i+=String.fromCharCode(63&e|128)):(i+=String.fromCharCode(e>>12|224),i+=String.fromCharCode(e>>6&63|128),i+=String.fromCharCode(63&e|128));return i}var c=function(){function t(t){var r=typeof t;return null===t?"null":"object"===r||"function"===r?e[n.call(t)]||"object":r}var e={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object","[object Error]":"error"},n=e.toString;return t}(),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.utilities={get_type:c,copy:e,merge:n,filter:r,encode_base64:o,encode_utf8:i}}(MAD),function(t,e){function n(t){if(!t)return null;var n=e.createElement("style"),o=n.styleSheet;return n.setAttribute("type","text/css"),o?o.cssText=t:n.insertBefore(e.createTextNode(t),null),r.insertBefore(n,null),n}var r=e.head||e.getElementsByTagName("head")[0];t.html={create_style:n}}(MAD,document),function(t){function e(t){var r=this;if(r instanceof e==!1)return new e(t);var c,a,u=r.transport=i();for(var l in t)c=o(r[l]),a=t[l],!t.hasOwnProperty(l)||"undefined"!==c&&c!==o(a)||(r[l]=a);var s=r.context||r,d=(r.method||"get").toUpperCase(),f=r.url,p=r.data;u.onreadystatechange=function(){n.call(r)},u.open(d,f,!0),"POST"===d?u.setRequestHeader("Content-type","application/x-www-form-urlencoded"):p&&(f=f+(f.indexOf("?")>-1?"&":"?")+p,p=null),r.before.call(s,r,t),u.send(p)}function n(t){var e,n,r=this.transport,o=this.context||this,i=r.readyState;if(4!==i)return null;try{e=r.status}catch(t){return null}if(200!==e)return null;var c,a=r.responseText;try{n=new Function("return ("+a+")")(),this.succeeded.call(o,n)}catch(t){c=t,this.failed.call(o,t)}this.completed.call(o,c,n),r.onreadystatechange=void 0}function r(){}var o=t.utilities.get_type,i=window.XMLHttpRequest?function(){return new XMLHttpRequest}:function(){return new ActiveXObject("Microsoft.XMLHTTP")};e.prototype={constructor:e,url:"",method:"GET",before:r,succeeded:r,failed:r,completed:r},t.XHR=e}(MAD),function(t){function e(t){var e=this;e.module_id=t,e.templates={},e.styles={},e.components={}}function n(t){this.update(t.resources);try{this.callback.call(this)}catch(t){throw t}}function r(t,e){var n,r;for(var o in e)n=(e[o]||"").trim(),e.hasOwnProperty(o)&&(r=s(n))&&(t[o]=r)}function o(t,e){var n,r;for(r in e)if(n=e[r],n&&"string"==typeof n&&e.hasOwnProperty(r))try{t[r]=new Function("return ("+n+");")()}catch(t){throw t}}function i(){}var c=t.utilities,a=c.copy,u=c.get_type,l=t.XHR,s=t.html.create_style;e.prototype={constructor:e,update:function(t){if("object"===u(t)){var e=this;a(t.templates,e.templates,!0),r(e.styles,t.styles),o(e.components,t.components)}},get:function(t,e){var r="";for(var o in t)t.hasOwnProperty(o)&&(r+=(r?"&":"")+encodeURIComponent(o)+"="+encodeURIComponent(t[o].join("|")));new l({url:"mad/module/"+this.module_id+"/resources",data:r,context:{collection:this,callback:e||i},succeeded:n})}},t.ResourceCollection=e}(MAD),function(t){function e(t){if("string"!=typeof t)throw"The module [id] must be a string.";this.id=t,this.resources=new n(t)}var n=t.ResourceCollection;e.prototype={constructor:e,initialize:function(){}},e.initialize=function(n,r){var o=n.id,i=n.source,c=n.resources;if(o&&i){var a=new e(o);try{new Function("return ("+i+");")().call(a,t),a.resources.update(c),a.initialize.apply(a,r)}catch(t){return null}return a}},t.Module=e}(MAD),function(t,e){function n(t,e,n){var u=d(e);"function"!==u&&(n=e,e=a),n=void 0===n?[]:n,n="array"===d(n)?n:[n];var s=f[t];if(s)return s.initialize.apply(s,n),e.apply(s,n),s;var p={module_id:t,callback:e,params:n};return new l({url:"mad/module/"+t,context:p,before:r,succeeded:o,failed:i,completed:c})}function r(){}function o(t){if(!t)return console.log("Exception: Module could not be loaded.");if(t.exception)return console.log("Exception: "+(t.exception||"Module could not be loaded."));var e=this,n=e.module_id,r=e.params,o=u.initialize(t,r);o&&(f[n]=o,e.callback.apply(o,r))}function i(t){throw t}function c(){}function a(){}var u=t.Module,l=t.XHR,s=t.utilities,d=s.get_type,f={};t.get_module=n}(MAD,window,document);